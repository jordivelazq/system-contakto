{% extends 'partials/base.html' %}
{% load static %}

{% block title %}{{ title }}{% endblock title %}

{% block extra_css %}
    <!-- Sweet Alert-->
    <link href="{% static 'libs/sweetalert2/dist/sweetalert2.min.css' %}" rel="stylesheet" type="text/css"/>
{% endblock extra_css %}


{% block content %}

    <!-- ============================================================== -->
    <!-- Start right Content here -->
    <!-- ============================================================== -->
    <!-- BEGIG MODAL INCLUDE -->
    {% include 'investigaciones/ejecutivo_de_cuenta/investigaciones_ejecutivo_lab_modal.html' %}
    <!-- END MODAL INCLUDE -->
    <div class="main-content">
        <div class="page-content">
            <div class="container-fluid">

                <div class="row" id="demanadas_laborales">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-body">

                                <h5>Empresas investigadas</h5>

                                <div class="table-rep-plugin">
                                    <div class="table-responsive mb-0" data-pattern="priority-columns">

                                        <table class="table table-striped table-bordered table-hover table-sm">

                                            <thead>
                                            <tr>
                                                <th>Empresa</th>
                                                <th>Fecha de Ingreso</th>
                                                <th>Fecha de Egreso</th>
                                                <th>Puesto</th>
                                                <th>Motivo de baja</th>
                                                <th>Terminada</th>
                                                <th>Visible en Estatus</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            {% for tl in tajectorias_laborales %}
                                                <tr>
                                                    <td>
                                                        {% if not tl.nombre_empresa %}
                                                            {{ tl.compania.nombre }}
                                                        {% else %}
                                                            {{ tl.nombre_empresa }}
                                                        {% endif %}
                                                        <br/>
                                                        <small>{{ tl.observaciones_generales|lower }}</small>
                                                    </td>
                                                    <td class="{% if not tl.periodo_alta %}text-danger{% endif %}">
                                                        {% if tl.periodo_alta %}
                                                            {{ tl.periodo_alta }}
                                                        {% else %}
                                                            <b>Sin Dato</b>
                                                        {% endif %}
                                                    </td>
                                                    <td class="{% if not tl.periodo_baja %}text-danger{% endif %}">
                                                        {% if tl.periodo_baja %}
                                                            {{ tl.periodo_baja }}
                                                        {% else %}
                                                            <b>Sin Dato</b>
                                                        {% endif %}
                                                    </td>
                                                    <td>{{ tl.puesto_final }}</td>
                                                    <td>{{ tl.datosgenerales.motivo_salida|default:'' }}</td>


                                                    <td class="text-center">
                                                        <i
                                                                class="fa fa-{% if tl.terminada %}check{% else %}times{% endif %}"></i>
                                                    </td>
                                                    <td class="text-center">
                                                        <i
                                                                class="fa fa-{% if tl.visible_en_status %}check{% else %}times{% endif %}"></i>
                                                    </td>

                                                </tr>
                                            {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>

                                <br/><br/>

                                <h3 class="card-title">Demandas laborales</h3>

                                <div class="row">

                                    <div class="col-md-12">
                                        <div class="table-responsive">
                                            <table class="table table-striped table-bordered table-hover" id="datatable">
                                                <thead>
                                                <tr>
                                                    <th>Demanda Laboral</th>
                                                    <th>Empresa</th>
                                                    <th>Motivo</th>
                                                    <th>Ubicacion</th>
                                                    <th>Fecha</th>
                                                    <th>Audencia</th>
                                                    <th>Conclusión</th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                {% for demanda in demandas %}
                                                    <tr>
                                                        <td>

                                                            {% if demanda.tiene_demanda == 0 %}
                                                                No
                                                            {% elif demanda.tiene_demanda == 1 %}
                                                                Si
                                                            {% endif %}
                                                        </td>
                                                        <td>{{ demanda.empresa }}</td>
                                                        <td>{{ demanda.motivo }}</td>
                                                        <td>{{ demanda.ubicacion }}</td>
                                                        <td>{{ demanda.fecha }}</td>
                                                        <td>{{ demanda.audiencias }}</td>
                                                        <td>{{ demanda.conclusion }}</td>
                                                    </tr>

                                                {% empty %}
                                                    <tr>
                                                        <td colspan="4">No existen demandas laborales para esta investigación</td>
                                                    </tr>
                                                {% endfor %}
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>

                            </div>



                            </div>
                        </div>
                    </div><!-- end col -->
                </div>
            </div> <!-- container-fluid -->
        </div>
        <!-- End Page-content -->


        {% block footer %}
            {% include 'partials/footer.html' %}
        {% endblock footer %}
    </div>
    <!-- end main content-->
    <input type="hidden" id="investigacion_id" name="investigacion_id" value="{{ investigacion.pk }}">
{% endblock content %}


{% block extra_js %}

    <!-- Sweet Alerts js -->
    <script src="{% static 'libs/sweetalert2/dist/sweetalert2.min.js' %}"></script>

    <!-- Sweet alert init js-->
    <script src="{% static 'js/system/sweetalert.inv.lab.detail.delete_empresa.init.js' %}"></script>
    <script src="{% static 'js/system/sweetalert.inv.lab.detail.init.js' %}"></script>


    <script>
        $(document).ready(function () {
            investigacion_id = $('#investigacion_id').val();
            $('[data-toggle="popover"]').popover();
            {% if investigacion.laboral_completado %}
                setTimeout(function () {
                    $('.can-hide').map(function (i, v) {
                        $(v).attr('disabled', true);
                        $(v).hide();
                    });
                }, 1000)

            {% endif %}
        });

    </script>

{% endblock extra_js %}